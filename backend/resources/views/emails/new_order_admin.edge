<!DOCTYPE html>
<html lang="fr" xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!--[if gte mso 15]>
  <xml>
    <o:OfficeDocumentSettings>
    <o:AllowPNG/>
    <o:PixelsPerInch>96</o:PixelsPerInch>
    </o:OfficeDocumentSettings>
  </xml>
  <![endif]-->
  <title>Nouvelle commande</title>
  <style type="text/css">
    body {
      margin: 0;
      padding: 0;
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }
    table {
      border-collapse: collapse;
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
    }
    img {
      border: 0;
      height: auto;
      line-height: 100%;
      outline: none;
      text-decoration: none;
      -ms-interpolation-mode: bicubic;
    }
    @media only screen and (max-width: 600px) {
      .container {
        width: 100% !important;
      }
      .mobile-padding {
        padding-left: 16px !important;
        padding-right: 16px !important;
      }
    }
  </style>
</head>
<body style="margin: 0; padding: 0; background-color: #f5f5f5; font-family: Arial, Helvetica, sans-serif;">
  <center>
    <table border="0" cellpadding="0" cellspacing="0" width="100%" style="background-color: #f5f5f5;">
      <tr>
        <td align="center" style="padding: 20px 0;">
          <!--[if (gte mso 9)|(IE)]>
          <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
          <tr>
          <td align="center" valign="top" width="600">
          <![endif]-->

          <!-- Main Container -->
          <table border="0" cellpadding="0" cellspacing="0" width="600" class="container" style="max-width: 600px; background-color: #ffffff; border-radius: 16px;">

            <!-- Header -->
            <tr>
              <td bgcolor="#10b981" style="background-color: #10b981; border-radius: 16px 16px 0 0; padding: 40px 20px; text-align: center; color: #ffffff;">
                <h1 style="margin: 0; font-size: 28px; font-weight: 700; color: #ffffff;">Nouvelle commande !</h1>
                <p style="margin: 4px 0 0; opacity: 0.9; color: #ffffff; font-size: 16px;">Une commande vient d'√™tre pass√©e</p>
              </td>
            </tr>

            <!-- Alert -->
            <tr>
              <td>
                <table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#d1fae5" style="background-color: #d1fae5; border-left: 4px solid #10b981; margin: 20px 30px;">
                  <tr>
                    <td style="padding: 15px 20px;">
                      <strong style="color: #065f46;">‚ö° Action requise :</strong>
                      <span style="color: #047857;">Une nouvelle commande n√©cessite votre attention.</span>
                    </td>
                  </tr>
                </table>
              </td>
            </tr>

            <!-- Content -->
            <tr>
              <td style="padding: 40px 30px;" class="mobile-padding">

                <!-- Order Number -->
                <table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#fef3c7" style="background-color: #fef3c7; border-left: 4px solid #f59e0b; margin: 0 0 20px; border-radius: 8px;">
                  <tr>
                    <td style="padding: 15px 20px; text-align: center;">
                      <div style="font-size: 14px; color: #92400e; margin-bottom: 5px;">Num√©ro de commande</div>
                      <strong style="color: #d97706; font-size: 20px;">{{ order.orderNumber }}</strong>
                    </td>
                  </tr>
                </table>

                <!-- Status Badge -->
                <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin: 0 0 20px;">
                  <tr>
                    <td align="center">
                      <table border="0" cellpadding="0" cellspacing="0" bgcolor="#fef3c7" style="background-color: #fef3c7; border-radius: 12px;">
                        <tr>
                          <td style="padding: 4px 12px;">
                            <span style="color: #d97706; font-size: 12px; font-weight: 600;">{{ order.status === 'pending' ? 'En attente' : order.status }}</span>
                          </td>
                        </tr>
                      </table>
                    </td>
                  </tr>
                </table>

                <!-- Customer Info Section -->
                <table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#f9fafb" style="background-color: #f9fafb; margin: 30px 0; border-radius: 8px;">
                  <tr>
                    <td style="padding: 20px;">
                      <h2 style="margin: 0 0 15px; font-size: 16px; font-weight: 600; color: #1f2937;">
                        üë§ Informations client
                      </h2>

                      <!-- Name -->
                      <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 12px;">
                        <tr>
                          <td style="width: 100px; color: #6b7280; font-size: 14px; font-weight: 500;">Nom :</td>
                          <td style="color: #111827; font-weight: 600;">{{ order.customerName }}</td>
                        </tr>
                      </table>

                      <!-- Email -->
                      <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 12px;">
                        <tr>
                          <td style="width: 100px; color: #6b7280; font-size: 14px; font-weight: 500;">Email :</td>
                          <td style="color: #111827; font-weight: 600;">{{ order.customerEmail }}</td>
                        </tr>
                      </table>

                      <!-- Phone -->
                      <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 12px;">
                        <tr>
                          <td style="width: 100px; color: #6b7280; font-size: 14px; font-weight: 500;">T√©l√©phone :</td>
                          <td style="color: #111827; font-weight: 600;">{{ order.customerPhone }}</td>
                        </tr>
                      </table>

                      @if(order.shippingAddress)
                      <!-- Address -->
                      <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 12px;">
                        <tr>
                          <td style="width: 100px; color: #6b7280; font-size: 14px; font-weight: 500; vertical-align: top;">Adresse :</td>
                          <td style="color: #111827; font-weight: 600; white-space: pre-line;">{{ order.shippingAddress }}</td>
                        </tr>
                      </table>
                      @end

                      @if(order.notes)
                      <!-- Notes -->
                      <table border="0" cellpadding="0" cellspacing="0" width="100%">
                        <tr>
                          <td style="width: 100px; color: #6b7280; font-size: 14px; font-weight: 500; vertical-align: top;">Notes :</td>
                          <td style="color: #111827; font-weight: 600;">{{ order.notes }}</td>
                        </tr>
                      </table>
                      @end
                    </td>
                  </tr>
                </table>

                <!-- Payment Method Section -->
                <table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#f9fafb" style="background-color: #f9fafb; margin: 30px 0; border-radius: 8px;">
                  <tr>
                    <td style="padding: 20px;">
                      <h2 style="margin: 0 0 15px; font-size: 16px; font-weight: 600; color: #1f2937;">
                        üí≥ M√©thode de paiement
                      </h2>

                      <!-- Method -->
                      <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-bottom: 12px;">
                        <tr>
                          <td style="width: 100px; color: #6b7280; font-size: 14px; font-weight: 500;">M√©thode :</td>
                          <td style="color: #111827; font-weight: 600;">
                            {{ order.paymentMethod === 'wero' ? 'Wero' : 'PayPal' }}
                          </td>
                        </tr>
                      </table>

                      <!-- Status -->
                      <table border="0" cellpadding="0" cellspacing="0" width="100%">
                        <tr>
                          <td style="width: 100px; color: #6b7280; font-size: 14px; font-weight: 500;">Statut :</td>
                          <td style="color: #d97706; font-weight: 600;">
                            ‚è≥ En attente de paiement manuel
                          </td>
                        </tr>
                      </table>
                    </td>
                  </tr>
                </table>

                <!-- Products Section -->
                <table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#f9fafb" style="background-color: #f9fafb; margin: 30px 0; border-radius: 8px;">
                  <tr>
                    <td style="padding: 20px;">
                      <h2 style="margin: 0 0 15px; font-size: 16px; font-weight: 600; color: #1f2937;">
                        üì¶ Produits command√©s
                      </h2>

                      <!-- Product Table -->
                      <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-top: 15px;">
                        <!-- Header -->
                        <tr bgcolor="#f3f4f6" style="background-color: #f3f4f6;">
                          <td style="padding: 10px; font-size: 13px; color: #6b7280; font-weight: 600; border-bottom: 2px solid #e5e7eb;">Produit</td>
                          <td style="padding: 10px; font-size: 13px; color: #6b7280; font-weight: 600; text-align: center; border-bottom: 2px solid #e5e7eb;">Qt√©</td>
                          <td style="padding: 10px; font-size: 13px; color: #6b7280; font-weight: 600; text-align: right; border-bottom: 2px solid #e5e7eb;">Prix unit.</td>
                          <td style="padding: 10px; font-size: 13px; color: #6b7280; font-weight: 600; text-align: right; border-bottom: 2px solid #e5e7eb;">Total</td>
                        </tr>

                        <!-- Products -->
                        @each(item in order.orderItems)
                        <tr>
                          <td style="padding: 12px 10px; font-size: 14px; border-bottom: 1px solid #e5e7eb;">
                            <div style="font-weight: 600; color: #111827;">{{ item.product ? item.product.name : 'Produit' }}</div>
                          </td>
                          <td style="padding: 12px 10px; font-size: 14px; text-align: center; border-bottom: 1px solid #e5e7eb;">{{ item.quantity }}</td>
                          <td style="padding: 12px 10px; font-size: 14px; text-align: right; border-bottom: 1px solid #e5e7eb;">{{ Number(item.unitPrice).toFixed(2) }} ‚Ç¨</td>
                          <td style="padding: 12px 10px; font-size: 14px; text-align: right; font-weight: 600; border-bottom: 1px solid #e5e7eb;">{{ Number(item.totalPrice).toFixed(2) }} ‚Ç¨</td>
                        </tr>
                        @end
                      </table>
                    </td>
                  </tr>
                </table>

                <!-- Total Section -->
                <table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#c19a6b" style="background-color: #c19a6b; margin-top: 20px; border-radius: 8px;">
                  <tr>
                    <td style="padding: 25px; text-align: center;">
                      <div style="font-size: 14px; color: #ffffff; opacity: 0.9; margin-bottom: 8px;">TOTAL DE LA COMMANDE</div>
                      <div style="font-size: 32px; font-weight: 700; color: #ffffff;">{{ Number(order.totalAmount).toFixed(2) }} ‚Ç¨</div>
                    </td>
                  </tr>
                </table>

                <!-- Action Button -->
                <table border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-top: 30px;">
                  <tr>
                    <td align="center">
                      <table border="0" cellpadding="0" cellspacing="0">
                        <tr>
                          <td bgcolor="#c19a6b" style="background-color: #c19a6b; border-radius: 8px; padding: 14px 32px;">
                            <a href="{{ frontendUrl }}/admin/orders" style="color: #ffffff; text-decoration: none; font-weight: 600; font-size: 16px; display: inline-block;">
                              Voir dans l'interface admin
                            </a>
                          </td>
                        </tr>
                      </table>
                    </td>
                  </tr>
                </table>

                <!-- Reminder -->
                <table border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#fef3c7" style="background-color: #fef3c7; margin: 30px 0; border-radius: 8px;">
                  <tr>
                    <td style="padding: 15px;">
                      <p style="margin: 0; font-size: 13px; color: #92400e;">
                        <strong>üí° Conseil :</strong> N'oubliez pas de mettre √† jour le statut de la commande une fois le paiement v√©rifi√© et les produits pr√©par√©s.
                      </p>
                    </td>
                  </tr>
                </table>

              </td>
            </tr>

            <!-- Footer -->
            <tr>
              <td bgcolor="#1f2937" style="background-color: #1f2937; padding: 30px; text-align: center; border-radius: 0 0 16px 16px;">
                <p style="margin: 0 0 10px; color: #9ca3af; font-size: 14px; line-height: 1.5;">
                  <strong style="color: #ffffff;">March√© de No√´l la Sainte Famille</strong>
                </p>
                <p style="margin: 0; color: #9ca3af; font-size: 13px;">Interface d'administration</p>
                <p style="margin: 15px 0 0; color: #9ca3af; font-size: 13px; line-height: 1.5;">
                  &copy; {{ currentYear }} Tous droits r√©serv√©s.
                </p>
              </td>
            </tr>

          </table>

          <!--[if (gte mso 9)|(IE)]>
          </td>
          </tr>
          </table>
          <![endif]-->
        </td>
      </tr>
    </table>
  </center>
</body>
</html>
